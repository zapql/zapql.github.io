(this.webpackJsonpzapql=this.webpackJsonpzapql||[]).push([[0],{110:function(t,n,e){},111:function(t,n,e){},136:function(t,n,e){"use strict";e.r(n);var a,i,r,c,o,s,d,b,l,p,h,j,u,g,m,x,f,O,v,w,y,k,E,I,C,B,D,z,M,S,q,A,F,L=e(0),N=e.n(L),H=e(40),P=e.n(H),J=(e(110),e(54)),T=(e(111),e(15)),U=e(44),R=e(30),G=e(16),Q=e(91),W=e(2),$=e(95),K="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzaGFyZCI6IjU1NjU5NjkxMDI5NSIsImlhdCI6MTYxNDA5NjI3Nn0.fNgOsRfM0y0-lQOZmhqn3NA7h3lR9EcOWyIiSqdTxBI",Z=Object($.a)((function(t,n){var e=n.headers;return{headers:Object(G.a)(Object(G.a)({},e),{},{authorization:"Bearer ".concat(K)})}})),V=new R.HttpLink({uri:"http://zapql.com:4000"}),X=new Q.a({uri:"ws://zapql.com:4000/graphql",options:{reconnect:!0}}),Y=Object(R.split)((function(t){var n=t.query,e=Object(W.q)(n);return"OperationDefinition"===e.kind&&"subscription"===e.operation}),X,Z.concat(V)),_=new R.ApolloClient({link:Y,cache:new R.InMemoryCache}),tt=e(65),nt=e.n(tt),et=e(157),at=e(160),it=e(156),rt=e(7),ct=e(8),ot=ct.b.div(a||(a=Object(rt.a)(["\n  @media (max-width: 30em) {\n    #Side {\n      visibility: collapse;\n    }\n  }\n"]))),st=ct.b.div(i||(i=Object(rt.a)(["\n    min-height: 10vh;\n"]))),dt=ct.b.img(r||(r=Object(rt.a)(["\n  height: 50px;\n  width: 50px;\n  object-fit: cover;\n  border-radius: 50%;\n"]))),bt=ct.b.div(c||(c=Object(rt.a)(["\n  width: calc(100% - 60px);\n  height: 46px;\n  padding: 15px 0;\n  margin-left: 10px;\n  border-bottom: 0.5px solid silver;\n  position: relative;\n"]))),lt=ct.b.div(o||(o=Object(rt.a)(["\n  margin-top: 5px;\n"]))),pt=ct.b.div(s||(s=Object(rt.a)(["\n  color: gray;\n  font-size: 15px;\n  margin-top: 5px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"]))),ht=ct.b.div(d||(d=Object(rt.a)(["\n  position: absolute;\n  color: gray;\n  top: 20px;\n  right: 0;\n  font-size: 13px;\n"]))),jt=e(5),ut=function(t){var n=t.chatListData,e=void 0===n?{contacts:{},chats:{}}:n;return Object(jt.jsxs)(ot,{"data-testid":"ChatDiv",children:[Object(jt.jsx)(st,{}),Object(jt.jsx)(it.a,{}),Object(jt.jsx)(et.a,{children:e.map((function(t){return Object(jt.jsxs)(at.a,{"data-testid":"chat",button:!0,component:U.b,to:"/chats/".concat(t.id),children:[Object(jt.jsx)(dt,{"data-testid":"picture",src:t.info.avatar,alt:"Profile"}),Object(jt.jsxs)(bt,{children:[Object(jt.jsx)(lt,{"data-testid":"name",children:t.info.name}),t.messages&&Object(jt.jsxs)(N.a.Fragment,{children:[Object(jt.jsx)(pt,{"data-testid":"content",children:t.messages[0].msg}),Object(jt.jsx)(ht,{"data-testid":"date",children:nt.a.unix(t.messages[0].timestamp).format("HH:mm")})]})]})]},t.id)}))})]})},gt=e(38),mt=e(75),xt=e(161),ft=e(158),Ot=Object(ct.b)(xt.a)(b||(b=Object(rt.a)(["\n    background-color: var(--primary-bg);\n    color: var(--primary-text);\n    font-size: 20px;\n    line-height: 40px;\n    position: relative;\n"]))),vt=Object(ct.b)(ft.a)(l||(l=Object(rt.a)(["\n  padding: 0;\n  display: flex;\n  flex-direction: row;\n  background-color: var(--primary-bg);\n  color: var(--primary-text);\n"]))),wt=ct.b.img(p||(p=Object(rt.a)(["\n  height: 40px;\n  width: 40px;\n  margin-top: 3px;\n  margin-left: -1vh;\n  object-fit: cover;\n  padding: 5px;\n  border-radius: 50%;\n"]))),yt=ct.b.div(h||(h=Object(rt.a)(["\n  line-height: 56px;\n  margin-left: 1vh;\n"]))),kt=function(t){var n=t.chatHeaderData;return Object(jt.jsx)("div",{"data-testid":"chat-header-outer-div",children:Object(jt.jsx)(Ot,{"data-testid":"chat-header-navbar",position:"relative",children:Object(jt.jsxs)(vt,{"data-testid":"chat-header-container",children:[Object(jt.jsx)(wt,{"data-testid":"chat-picture",src:n.avatar}),Object(jt.jsx)(yt,{"data-testid":"chat-name",children:n.name})]})})})},Et=ct.b.div(j||(j=Object(rt.a)(["\n  display: block;\n  flex: 2;\n  overflow-x: hidden;\n  overflow-y: auto;\n  padding: 0 14vh;\n\n  scrollbar-color: rgba(0,0,0,.2) hsla(0,0%,100%,.1);\n  scrollbar-width: thin;\n}\n"]))),It=ct.b.div(u||(u=Object(rt.a)(["\ndisplay: inline-block;\nposition: relative;\nmax-width: 100%;\nborder-radius: 7px;\nbox-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);\nmargin-top: 10px;\nmargin-bottom: 10px;\nclear: both;\n\n&::after {\n  content: '';\n  display: table;\n  clear: both;\n}\n\n&::before {\n  content: '';\n  position: absolute;\n  bottom: 3px;\n  width: 12px;\n  height: 19px;\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n\n","\n"])),(function(t){return t.isMine?Object(ct.a)(g||(g=Object(rt.a)(["\n        float: right;\n        background-color: #dcf8c6;\n\n        &::before {\n          right: -11px;\n          background-image: url(/assets/message-mine.png);\n        }\n      "]))):Object(ct.a)(m||(m=Object(rt.a)(["\n        float: left;\n        background-color: #fff;\n\n        &::before {\n          left: -11px;\n          background-image: url(/assets/message-other.png);\n        }\n      "])))})),Ct=ct.b.div(x||(x=Object(rt.a)(["\n  padding: 5px 7px;\n  word-wrap: break-word;\n  max-width: 80vh;\n\n  &::after {\n    content: ' \\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0';\n    display: inline;\n  }\n\n  ","\n"],["\n  padding: 5px 7px;\n  word-wrap: break-word;\n  max-width: 80vh;\n\n  &::after {\n    content: ' \\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0';\n    display: inline;\n  }\n\n  ","\n"])),(function(t){return t.isError?Object(ct.a)(f||(f=Object(rt.a)(["\n        font-style: italic;\n        color: gray;    \n    "]))):Object(ct.a)(O||(O=Object(rt.a)([""])))})),Bt=ct.b.div(v||(v=Object(rt.a)(["\n  position: absolute;\n  bottom: 2px;\n  right: 7px;\n  color: gray;\n  font-size: 12px;\n"]))),Dt=function(t){var n=t.messageListData,e=void 0===n?[]:n,a=t.chatId;return Object(L.useEffect)((function(){document.getElementById("message-list-container").scrollTop=document.getElementById("message-list-container").scrollHeight})),Object(jt.jsx)(Et,{id:"message-list-container",children:e.map((function(t){return Object(jt.jsxs)(It,{isMine:t.from!==a,"data-testid":"message-item",children:[Object(jt.jsx)(Ct,{isError:!!t.isError,"data-testid":"message-content",children:t.msg}),Object(jt.jsx)(Bt,{"data-testid":"message-date",children:nt.a.unix(t.timestamp).format("HH:mm")})]},t.wid)}))})},zt=ct.b.span(w||(w=Object(rt.a)(['\n    background: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"></path></svg>\');\n    width: 24px;\n    height: 24px;\n']))),Mt=function(){return Object(jt.jsx)(N.a.Fragment,{children:Object(jt.jsx)(zt,{"data-testid":"send","data-icon":"send"})})},St=e(159),qt=ct.b.div(y||(y=Object(rt.a)(["\n  background-color: var(--rich-text-panel-background);\n  display: flex;\n  height: 50px;\n  border-left: 30px;\n  padding-top: 1.5vh;\n  padding-bottom: 1.5vh;\n  padding-left: 1.5vh;\n  padding-right: 1.5vh;\n  width: calc(100% - 3vh);\n"]))),At=ct.b.input(k||(k=Object(rt.a)(["\n  width: calc(100% - 50px);\n  border: none;\n  border-radius: 999px;\n  padding: 10px;\n  padding-left: 20px;\n  padding-right: 20px;\n  font-size: 15px;\n  outline: none;\n  box-shadow: 0 1px silver;\n  font-size: 18px;\n  line-height: 45px;\n"]))),Ft=Object(ct.b)(St.a)(E||(E=Object(rt.a)(["\n  min-width: 50px !important;\n  width: 50px !important;\n  border-radius: 999px !important;\n  background-color: var(--rich-text-panel-background) !important;\n  margin: 0 5px !important;\n  margin-right: 0 !important;\n  color: var(--icon) !important;\n  padding-left: 20px !important;\n  \n  svg {\n    margin-left: -3px;\n  }\n"]))),Lt=function(t){var n=t.onMessage,e=t.chatId,a=t.inputState,i=t.setInputState;Object(L.useEffect)((function(){document.getElementById("message-input").focus()}),[e]);var r=function(){return!!a[e]&&n({variables:{to:e,msg:a[e]}})};return Object(jt.jsxs)(qt,{children:[Object(jt.jsx)(At,{"data-testid":"message-input",id:"message-input",type:"text",placeholder:"Type a message",value:a[e]||"",onKeyPress:function(t){if(13===t.charCode)return r()},onChange:function(t){var n=t.target;i(Object(G.a)(Object(G.a)({},a),{},Object(gt.a)({},e,n.value)))}}),Object(jt.jsx)(Ft,{"data-testid":"send-button",id:"send-button",onClick:function(){return r()},children:Object(jt.jsx)(Mt,{})})]})},Nt=ct.b.div(I||(I=Object(rt.a)(["\n  background: url(/assets/chat-background.jpg);\n  display: flex;\n  flex-flow: column;\n  height: 100vh;\n"]))),Ht=Object(R.gql)(C||(C=Object(rt.a)(["\n    mutation SendMessage($to: String!, $msg: String!) {\n        sendtextmessage(input: {\n            to: $to, \n            msg: $msg\n    }) {\n        wid\n        timestamp\n        to\n        from\n        msg\n        quote\n        forwarded\n    }\n}"]))),Pt=function(t){document.getElementById("message-input").disabled=t,document.getElementById("send-button").disabled=t},Jt=function(t,n,e){Pt(!1);try{if(null===t.type)throw new Error("Retorno nulo de mutation.");if(t.networkError)throw new Error("Network Error: the entire query was rejected.");if(t.graphQLErrors)throw new Error("GrapgQL Error: failed resolvers on parse, validation or execution phase.");throw new Error("Unknow Error")}catch(a){console.error(a),console.table(t)}finally{n((function(t){return Object(G.a)(Object(G.a)({},t),{},{chats:Object(G.a)(Object(G.a)({},t.chats),{},Object(gt.a)({},e,[].concat(Object(mt.a)(t.chats[e]),[{wid:"error-".concat(Math.random()),msg:"Sua mensagem n\xe3o p\xf4de ser enviada.",isError:!0,timestamp:Date.now()/1e3}])))})}))}},Tt=function(t){var n=t.chatRoomData,e=void 0===n?{id:"",info:{},messages:[]}:n,a=t.dispatch,i=Object(L.useState)({}),r=Object(J.a)(i,2),c=r[0],o=r[1];Object(L.useEffect)((function(){c.hasOwnProperty(e.id)||o((function(t){return Object(G.a)(Object(G.a)({},t),{},Object(gt.a)({},e.id,""))}))}),[c,e.id]);var s=Object(R.useMutation)(Ht,{onError:function(){}}),d=Object(J.a)(s,2),b=d[0],l=d[1],p=l.loading,h=l.error,j=l.data;return Object(L.useEffect)((function(){if(p&&Pt(!0),h)return Jt(h,a,e.id);if(j){if(null===j[0])return Jt({type:null},a,e.id);var t=Object.keys(j)[0];Pt(!1),o(Object(G.a)(Object(G.a)({},c),{},Object(gt.a)({},e.id,""))),document.getElementById("message-input").focus(),a((function(n){return Object(G.a)(Object(G.a)({},n),{},{chats:Object(G.a)(Object(G.a)({},n.chats),{},Object(gt.a)({},e.id,[].concat(Object(mt.a)(n.chats[e.id]),[Object(G.a)({},j[t])])))})}))}}),[p,h,j]),Object(jt.jsx)(N.a.Fragment,{children:e.id?Object(jt.jsxs)(Nt,{"data-testid":"CallServiceContainer",children:[Object(jt.jsx)(kt,{chatHeaderData:e.info}),Object(jt.jsx)(Dt,{messageListData:e.messages,chatId:e.id}),Object(jt.jsx)(Lt,{onMessage:b,chatId:e.id,inputState:c,setInputState:o})]}):Object(jt.jsx)(T.a,{to:"/chats"})})},Ut=ct.b.div(B||(B=Object(rt.a)(["\n  background-color: var(--intro-background);\n  display: flex;\n  flex-flow: column;\n  height: 100vh;\n"]))),Rt=ct.b.div(D||(D=Object(rt.a)(["\n  z-index:1;\n  box-sizing:border-box;\n  display:flex;\n  flex-direction: column;\n  flex-grow:1;\n  align-items:center;\n  justify-content:center;\n"]))),Gt=ct.b.div(z||(z=Object(rt.a)(['\n  background-image: url("/assets/intro-connection-light.jpg");\n  background-repeat: no-repeat;\n  order: 1;\n  min-width:60vh;\n  height: 60vh;\n  margin: 0 auto;\n']))),Qt=ct.b.h1(M||(M=Object(rt.a)(["\n  display:flex;\n  order: 2;\n  font-size: 32px;\n  font-weight: 300;\n  color: var(--primary-title);\n  text-align:center;\n"]))),Wt=ct.b.div(S||(S=Object(rt.a)(["\n  display:flex;\n  order: 3;\n  font-size: 14px;\n  line-height: 20px;\n  color: var(--intro-secondary);\n"]))),$t=function(){return Object(jt.jsx)(Ut,{"data-testid":"DashboardContainer",children:Object(jt.jsxs)(Rt,{children:[Object(jt.jsx)(Gt,{}),Object(jt.jsx)(Qt,{children:"Keep your phone connected"}),Object(jt.jsx)(Wt,{children:"WhatsApp connects to your phone to sync messages. To reduce data usage, connect your phone to Wi-Fi."})]})})},Kt=ct.b.div(q||(q=Object(rt.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  width: 100%;\n"]))),Zt=ct.b.div(A||(A=Object(rt.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-basis: 100%;\n  flex: 0.85\n"]))),Vt=ct.b.div(F||(F=Object(rt.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-basis: 100%;\n  flex: 2\n"]))),Xt=function(t){var n=t.state,e=t.dispatch,a=Object(T.g)().chatId,i=Object.entries(n.contacts),r=Object.entries(n.chats),c=i.map((function(t,n){return Object.assign({},{id:t[0]},{info:t[1]},{messages:r[n][1]})})),o=c.find((function(t){return t.id===a}));return Object(jt.jsxs)(Kt,{children:[Object(jt.jsx)(Zt,{id:"Side","data-testid":"Side",children:Object(jt.jsx)(ut,{chatListData:c})}),Object(jt.jsx)(Vt,{"data-testid":"Main",children:a?Object(jt.jsx)(Tt,{chatRoomData:o,dispatch:e}):Object(jt.jsx)($t,{})})]})},Yt={prop1:"Propriedade Um",contacts:{554498455712:{name:"Jackson",status:"Understand however that every man is worth just so much as the things are worth about which he busies himself.",avatar:"https://373819-1169963-raikfcquaxqncofqfm.stackpathdns.com/wp-content/uploads/2016/07/epictetus.jpg"},556599375661:{name:"Itacir Gabral",status:"\ud83e\udd14",avatar:"https://images-na.ssl-images-amazon.com/images/I/81eUW9G6mML.jpg"}},chats:{554498455712:[{type:"textMessage",timestamp:"1613415699",to:"554498455712",from:"556596910295",msg:"Qual a boa?",wid:"EAF75BB00E5CB33C405B80DAC79D015D"},{type:"textMessage",timestamp:"1613415699",to:"556596910295",from:"554498455712",msg:"Pa\xe7oca",wid:"EAF75BB00E5CB33C405B80DAC79D015E"}],556599375661:[{type:"textMessage",timestamp:"1613415688",to:"556596910295",from:"556599375661",msg:"opa e ai ze",wid:"EAF75BB00E5CB33C405B80DAC79D015B"},{type:"textMessage",timestamp:"1613415699",to:"556599375661",from:"556596910295",msg:"tudo",wid:"EAF75BB00E5CB33C405B80DAC79D015C"}]}},_t=function(){var t=Object(L.useState)(Yt),n=Object(J.a)(t,2),e=n[0],a=n[1];return Object(jt.jsx)(R.ApolloProvider,{client:_,children:Object(jt.jsx)(U.a,{children:Object(jt.jsxs)(T.d,{children:[Object(jt.jsx)(T.b,{path:"/chats/:chatId?",children:Object(jt.jsx)(Xt,{state:e,dispatch:a})}),Object(jt.jsx)(T.b,{exact:!0,path:"/",render:function(){return Object(jt.jsx)(T.a,{to:"/chats"})}})]})})})},tn=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,162)).then((function(n){var e=n.getCLS,a=n.getFID,i=n.getFCP,r=n.getLCP,c=n.getTTFB;e(t),a(t),i(t),r(t),c(t)}))};P.a.render(Object(jt.jsx)(N.a.StrictMode,{children:Object(jt.jsx)(_t,{})}),document.getElementById("root")),tn()}},[[136,1,2]]]);
//# sourceMappingURL=main.dee0c9ae.chunk.js.map